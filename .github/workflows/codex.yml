name: Codex Assistant

on:
  issue_comment:
    types: [created]
  pull_request_review_comment:
    types: [created]
  issues:
    types: [opened, assigned]
  pull_request_review:
    types: [submitted]

permissions:
  contents: read
  pull-requests: read
  issues: read

jobs:
  codex:
    # Respond only when explicitly invoked in a comment, while still allowing
    # events such as issue assignment/open to be handled by the action.
    if: >-
      github.event_name != 'issue_comment' ||
      contains(github.event.comment.body, '@codex')
    runs-on: ubuntu-latest
    steps:
      - name: Run Codex
        uses: openai/codex-action@v1
        with:
          openai-api-key: ${{ secrets.OPENAI_API_KEY }}
